# 프로그램의 발전과정

## 클라이언트 PC기반 프로그램
  - 클라이언트 PC에서 실행하면서 모든 기능을 수생하는 프로그램
    - ex)워드, 엑셀, 한컴, 각종 설치류 게임 등등
  - 즉 설치해서 사용하는 프로그램들을 의미한다.
  - 이러한 프로그램의 한계는 새로운 소스코드가 추가될 때 이것을 사용자가 다운로드, 설치해 업그레이드하고 프로그램을 껏다 켜야한다는 점이다.
  - 또한 DB 접속 정보 등이 쉽게 외부로 노출될 수 있다는 단점이 있다.


## 클라이언트-서버 프로그램
  - 클라이언트-서버가 ㅊ연결되어 있는 프로그램
  - 클라이언트는 화면기능, 데이터 송수신만 제공하고 모든 기능은 서버에서 수행한다
    - 클라이언트는 모니터 역할, 서버가 본체 역할인 것
### 특징
  - 기능(로직)이 변경되어도 모두 서버에서 처리하기에 클라이언트의 소스코드, 프로그램은 수정할 필요가 없음
  - 중요한 기능은 서버에 모두 있기에 보안 측면에서 유리
  - 단 GUI 화면이 바뀌면 클라이언트가 수정되어야 하는 것은 어찌보면 당연.

## 웹 기반 프로그램
  - 와면과 데이터 처리 모두 서버에서 수행.
  - 흔히 우리가 아는 웹 페이지가 이에 해당
    1. url을 통해 브라우저(클라이언트)가 웹 페이지를 요청
    2. 서버는 브라우저가 요청한 데이터를 확인해 처리.
    3. 브라우저는 서버가 처리하고 전송한 결과값을 HTML을 통해 화면에 표시

### 특징
  - 화면과 로직을 서버에서 모두 처리하기에 클라이언트(브라우저)가 직접 수행할 작업은 없음
  - 클-서버 프로그램처럼 서버에서 모두 작업을 처리하기에 보안측면에서 우월

# 웹 프로그래밍과 JSP
## 웹 프로그래밍의 기본

### 정적(static) 웹프로그램
  - 웹 서버(Like Apache)에 미리 보여줄 HTML 페이지, CSS, 이미지, 자바스크립트 파일을 저장해 놓고 브라우저가 요청할 때마다 그대로 전달하는 방식
  - 사용자는 고정된 웹 페이지만을 보게 됨(마치 PDF파일과 같은 개념)
  - 주로 화면의 디자인을 구성하거나 클라이언트의 이벤트를 처리
  - 환율, 주가 정보처럼 실시간 정보를 표시하는데는 부적합한 방법

#### 정적 웹 프로그램의 구성요소
  - 웹서버 : 각 클라이언트에게 서비스를 제공하는 컴퓨터를 의미
  - 클라이언트 : 네트워크로 서버에 접속한 후 서버로 부터 서비스를 제공받는 컴퓨터를 의미
  - HTTP 프로토콜 : Hyper Transfer Protocol의 약자로 www서비스를 제공하는 통신 규약을 의미. 웹 서버와 클라이언트는 이 프로토콜을 이용해 정보를 주고 받는다.(통신을 위한 데이터 양식(format)의 개념)
  - 자바스크립트: HTML 웹 페이지의 여러가지 동적 기능을 제공하는 스크립트 언어
  - CSS(Style Sheet): HTML 문서에서 서체, 색상, 정렬 등 세부적인 HTML 페이지 디자인 관련 기능을 재공하는 마크업 언어

#### 정적 프로그래밍의 단점
  - 주가, 환율과 같이 실시간으로 변하는 정보를 제공하는데 한계.
  - 관리자가 주기적으로 수동 업데이트 해야함
  - 보통 사용자에게 디자인 고정된 정보만 제공하는데 쓰인다.


#### 동적(dynamic) 웹 프로그램
  - 정적 웹프로그래밍에서 관리자가 하던 역할을 WAS(Web Application Server)가 수행한다.,
  - 클라이언트 요청이 있을 때마다 이를 서버가 WAS에 전달하고 WAS가 DB에 접근해 실시간 정보를 가져와 거꾸로 클라이언트에게 전달
  - 처음에 동적인 방식으로 프로그램에 제공하는 기능은 CGI(Common Gate Interface, 공용 게이트웨이 인터페이스)였다.
  - 프로그래밍 언어인 펄(perl)이 대표적인 CGI언(옛날 방식이고 서버부하가 심한 방법이기에 따로 설명 안 함)


## JSP(Java Server Page) 프로그램의 특징
  - 이전 CGI방식을 개선하여 등장하였다
  - 브라우저가 요청을 하면 쓰레드방식으로 실행하므로 보다 효율적으로 기능 수행

  <img src="../images\JSP 쓰레드 방식" width= "600px" height = "400px" />

  - 클라이언트1이 정보요청시 WAS는 환율 조회 기능을 메모리에 생성한 후 DB와 연동, 가져온 정보를 클1에게 반환
  - 클라이언트2가 다시 같은 요청을 할 때 기존에 메모리에 생성했던 환율정보 기능을 그대로 이용해 클2에게 정보 전송
  - 프로세스 방식이 아닌 쓰레드 방식으로 실행
  - 클라이언트 요구를 처리하는 기능은 최초 한번만 메모리에 로드됨
  - 클라이언트가 동일한 기능을 요구하면 기존에 로드한 기능을 재사용
  - 따라서 CGI의 프로세스 방식보다 훨씬 빠름

## 웹 어플리케이션의 이해
  - 기존의 정적 웹 어플리케이션 기능을 그대로 사용하되 서블릿, JSP, 자바 클래스들을 추가하여 사용자에게 동적 서비스를 제공하는 프로그램
  - 앞서 언급했듯이 정적 앱은 디자인이나 이벤트를 처리하는데 쓰이고 다른 부분을 동적으로 사용한다.

### 웹 어플리케이션의 기본 구조
  - 톰캣 같이 컨테이너에서 실행되는 웹 어플리케이션은 일정한 디렉토리 구조를 갖추어야 한다.

  <img src="../images\웹어플리케이션기본구조" width= "600px" height = "400px" />  

  | 구성요소 | 기능 |
  |:---|:---|
  | `웹 어플 이름` | 웹 어플리케이션의 루트 디렉토리(폴더). 다른 웹 어플리케이션 이름과 중복을 허용하지 않으며 여기에는 JSP HTML 파일이 저장된다.  |
  | `WEB-INF` | 웹 어플리케이션에 관한 정보가 저장되는 곳. 해당 디렉토리는 외부에서 접근이 불가능 |
  | `classes` | 웹 어플리케이션이 수행하는 서블릿과 다른 일반 클래스들이 위치한 곳 |
  | `lib` | 웹 어플리케이션에서 사용되는 여러가지 라이브러리 압축파일(.jar)이 저장되는 곳. DB 연동 드라이버나 프레임워크 기능 관련 jar 파일이 저장됨. lib 디렉토리의 jat는 클래스패스가 자동 설덩된다. |
  | `web.xml` | 배치 지시자(deployment descriptor)로서 일종의 환경 설정 파일입니다. 웹 어플리케이션에 대한 여러가지 설정을 할 때 사용됩니다. |

  - 기본적인 구조는 이렇게 이루어지지만 실제 웹 어플리케이션 디렉토리에는 JSP, HTML 파일을 저장하는 디렉토리가 추가되기도 한다
  - 또한 WEB_INF 내부에도 3가지 이외에 다양한 기능을 수행하는 디렉토리가 포함된다(ex. bin, src 등등)
  | 구성요소 | 기능 |
  |:---|:---|
  | `jsp, html` | JSP 파일과 HTML 파일이 저장되는 곳 |
  | `css` | 스타일시트 파일이 저장되는 곳 |
  | `image` | 웹 어플리케이션에서 사용되는 이미지가 저장되는 곳 |
  | `js` | 자바스크립트 파일이 저장된 곳 |
  | `bin` | 어플리케이션에서 사용되는 각종 실행 파일이 저장된 곳 |
  | `conf` | 프레임워크에서 사용하는 각종 설정파일이 저장된 곳 |
  | `src` | 자바 소스 파일이 저장된 곳 |

### 컨테이너에 웹 어플리케이션 등록하기(JDK이전 방식)
  - 웹 어플리케이션은 일반 PC에서 실행되는 자바 어플리케이션과 달리 단독으로 실행이 불가
  - 웹 어플리케이션은 톰캣과 같은 웹 컨테이너에서 실행되는 구조
  - 웹 어플리케이션을 실행하려면 우선 톰캐셍 등록을 해야 함
    - %CATALINA+HOME%webApp 디렉토리에 어플리케이션 저장
    - server.xml에 직접 웹 어플리케이션을 등록
  ※ JDK의 루트 디렉토리를 환경설정에서 JAVA_HOME로 설정했듯이 톰캣의 루트 디렉토리는 일반적으로 CATALINA_HOME으로 설정한다.

### 컨텍스트란?
  - 톰캣의 server.xml에 등록하는 웹 어플리케이션을 컨텍스트(Context)이라고 부른다.
  - 즉 톰캣 입장에서 인식하는 한 개의 웹 어플리케이션.

#### 컨텍스트의 특징
  - 웹 어플리케이션당 하나의 컨텍스트가 등록된다.
  - 웹 어플리케이션 이름과 중복 가능
  - 컨텍스트 이름은 서로 중복불가
  - 웹 어플리케이션의 의미를 가장 잘 나타낼 수 있는 명사형으로 지정
  - 대소문자 구분
  - server.xml에 등록

#### 톰캣 컨테이너에 컨텍스트 등록
  - 톰캣 설치 루트 디렉토리의 conf 디렉토리의 server.xml에 설정한다

#### <Context> 태그란?
    - 톰캣은 모든 설정 정보를 XML로 저장한 후 실행 시 정보를 읽어와 설정대로 실행함
    - 우리가 만든 웹 어플리케이션도 미리 <Context> 태그를 이용해 server.xml에 등록해 두어야 톰캣이 설정한대로 웹 어플리케이션을 실행한다
    - 간단히 축약하자면 url 중에서 로컬host/이후에 들어갈 url 단어를 의미한다고 이해하면 편하다.  

#### <Context> 태그 구성요소의 기능
  | 구성요소 | 기능 |
  |:---|:---|
  | `path` | 웹 어플리케이션의 컨텍스트 이름. 웹 어플리케이션 이름과 다를 수도 있으며, 웹 브라우저에서 실제 웹 어플리케이션을 요청하는 이름. |
  | `docBase` | 컨텍스트에 대한 실제 웹 어플리케이션이 위치한 경로. WEB-INF 상위 폴더까지의 경로를 나타냄 |
  | `reloadable` | 실행 중 소스 코드가 수정될 경우 바로 갱신할지를 설정한다. 만약 false라면 톰캣을 다시 실행해야만 추가된 소스코드의 기능을 실행할 수 있다. |
  - 예시
  ```xml
  <!--Context path="/컨텍스트 이름" docbase="실제 웹 어플리케이션의 WEB-INF 디렉토리 위치" reloadable="true나 false" />  -->
  <Context path="/webMal" docbase="C:\\webShop" reloadable="true" />
  ```
  - 위 코드 한줄이 하나의 웹 어플리케이션, 즉 컨텍스트이다.
#### 톰캣 컨테이너에서의 웹 어플리케이션 동작 과정
              ----->
    웹브라우저         웹컨테이너
              <-----      
  - 웹 브라우저에서 컨텍스트 이름(webMal)으로 요청
    - Ex.http//주소:포트번호/프로젝트명/패키지명까지 포함된 클래스->http//주소:포트번호/프로젝트명/컨텍스트이름)
  - 요청을 받은 톰캣 컨테이너는 요청한 컨텍스트 이름이 server.xml에 있는지 확인
  - 해당 컨텍스트 이름이 있다면 컨텍스트 이름에 대한 실제 웹 어플리케이션이 있는 경로(우리가 docBase로 설정한 위치, C:/webShop)로 가서 요청한 main.html을 클라이언트 웹 브라우저로 전송
  - 웹 브라우저는 전송된 main.html을 브라우저에 표시

### 배치(Deploy)란?
    - 개발이 완료된 웹 어플리케이션을 실제 사용자들에게 서비스하기 위한 작업
